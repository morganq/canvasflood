<html>
<head>
	<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
	<script src="https://rawgithub.com/nodeca/pako/master/dist/pako.js"></script>
	<script>
		$(document).ready(function() {
			var cvs = document.getElementById("canvas");
			var ctx = cvs.getContext("2d");

			sock = new WebSocket("ws://54.153.106.51:8080/delta");
			sock.binaryType='arraybuffer';
			
			sock.onmessage = function(event) {
				console.log("received " + event.data.byteLength + " bytes");
				//console.log(event.data);
				var outdata = pako.inflate(event.data);
				//console.log(outdata);
				
				var px = new Uint8Array(outdata);
				//px = event.data;
				var img = ctx.createImageData(800,600);
				//img.data = px;
				for(var i = 0; i < img.data.length; i++) {
					img.data[i] = px[i];
				}
				ctx.putImageData(img, 0, 0);
			}

		})
	</script>

</head>
<body>
	<canvas id="canvas" width="800" height="600"></canvas>
</body>
</html>
